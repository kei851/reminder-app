# リマインダーシステム

柔軟なリマインド設定と Slack スレッド対応のリマインダーシステム

## ファイル構成

メンテナンス性を重視した4ファイル構成：

- **config.js** - Slackトークンとシート参照の設定
- **daily_do.js** - メイン処理（リマインダー実行、テスト、トリガー設定）
- **post_message.js** - Slackメッセージ投稿とスレッド管理
- **util.js** - ユーティリティ関数（データ処理、日付計算）

## セットアップ

### 1. Google Sheets の準備

以下の 3 つのシートを作成：

#### リマインダー設定

| A 列       | B 列     | C 列             | D 列           |
| ---------- | -------- | ---------------- | -------------- |
| 期日       | 名前     | リマインダー種類 | スレッドリンク |
| 2025-07-15 | 田中太郎 | Pitch会          | (自動入力)     |

#### すべてのslackメンバー

| A 列     | B 列 | C 列      | D 列 | E 列         |
| -------- | ---- | --------- | ---- | ------------ |
| id       | name | name_only | -    | name_26only  |
| U1234567 | -    | 田中太郎  | -    | -            |

#### リマインド文マスター

| A 列    | B 列           | C 列     | D 列                                  | E 列               |
| ------- | -------------- | -------- | ------------------------------------- | ------------------ |
| セット名| リマインダー名 | タイミング| 文章                                  | デフォルトチャンネル|
| Pitch会 | Pitch会(22日前)| 22日前   | 📝 初稿提出を{DEADLINE}にお願いします | #pitch-general     |

**Pitch会の設定例（リマインド文マスターに追加）：**
```
Pitch会 | Pitch会(22日前) | 22日前 | 明日までに初期資料を提出してください。{DEADLINE} | #pitch-general
Pitch会 | Pitch会(14日前) | 14日前 | 上司に最終レビューを依頼しましょう！{DEADLINE} | #pitch-general
Pitch会 | Pitch会(7日前)  | 7日前  | HRの方のレビュー、FBを受けてスライドの修正、発表練習をやりましょう！{DEADLINE} | #pitch-general
Pitch会 | Pitch会(2日前)  | 2日前  | スライドの最終確認と、発表練習をやりましょう！{DEADLINE} | #pitch-general
```

**メッセージのテンプレート変数**:

- `{DEADLINE}` - 自動で期日詳細に置換
  - 例: 「明日（6 月 24 日）の 24 時まで」
  - 例: 「3 日後（6 月 26 日）の 24 時まで」

### 2. Google Apps Script の設定

1. **新しいGASプロジェクトを作成**
2. **4つのファイルを順番にコピー**：
   - `config.js` の内容をコピーして、`token` と `channelId` を設定
   - `util.js` の内容をコピー
   - `post_message.js` の内容をコピー
   - `daily_do.js` の内容をコピー
3. **トリガーを設定**：
   - `setupTrigger()` 関数を1回実行（毎日9時に自動実行設定）

## 使い方

### Pitch 会の場合

1. **リマインド文マスターにPitch会の設定を追加**（上記の設定例を参考）
2. **リマインダー設定に発表者 3 人を登録**：

```
2025-07-15 | 田中太郎 | Pitch会
2025-07-15 | 佐藤花子 | Pitch会
2025-07-15 | 鈴木一郎 | Pitch会
```

3. **自動で以下が実行される**：
   - 22 日前：初期資料提出リマインド（スレッド開始）
   - 14 日前：上司レビューリマインド（スレッド返信）
   - 7 日前：HR レビューリマインド（スレッド返信）
   - 2 日前：最終確認リマインド（スレッド返信）

### その他のリマインド

1. **リマインド文マスターに新しいリマインダーを追加**：

```
個人用 | 提出物リマインド | 7日前 | 📋 提出を{DEADLINE}にお願いします | #general
```

2. **リマインダー設定に対象者を登録**：

```
2025-08-01 | 山田太郎 | 提出物リマインド
```

## 機能

- **期日同じ人自動まとめ**: 同じ期日の人が自動的にグループ化される
- **スレッドリンク自動記録**: D列にSlackスレッドURLが自動で記録される
- **デフォルトチャンネル**: マスターでチャンネルを一元管理
- **セット・個別対応**: セット名または個別リマインダー名で設定可能
- **完全スプレッドシート管理**: すべての設定がスプレッドシートで変更可能

## テスト

`testReminder()` 関数を実行してテスト可能

## 重要：コード内にハードコードなし

**すべての設定がスプレッドシートで管理されています。**
- リマインダーの内容変更 → リマインド文マスターを編集
- 期日・対象者変更 → リマインダー設定を編集
- チャンネル変更 → リマインド文マスターのE列を編集

**コードを触る必要は一切ありません！**